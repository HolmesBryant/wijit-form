<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wijit-Form Web Component</title>
    <link rel="stylesheet" href="styles.css">
    <script type="module" src="wijit-form.js"></script>
    <script type="module" src="wijit-icon01.js"></script>

    <!-----------------------------------------
     You can change the colors of the form by changing the values of these css variables
    ------------------------------------------->
    <style>
        wijit-form {
            --bg1: rgb(250,250,250);
            --bg2: rgb(245,245,245);
            --bg3: white;
            --text: rgb(60,60,60);
            --border: silver;
            --fail: hsl(6, 93%, 80%);
            --pass: hsl(112, 70%, 75%);
            --accent: lightskyblue;

            @media (prefers-color-scheme: dark) {
                --text: rgb(240,240,240);
                --bg1: rgb(35,35,35);
                --bg2: rgb(40,40,40);
                --bg3: rgb(60,60,60);
                --accent: dodgerblue;
                --border: dimgray;
            }
        }

    </style>
</head>
<body>
    <details>
        <summary><h1>Wijit Form Web Component</h1></summary>
        <article>
            <p><a href="/tests/test-attributes.html" target="_blank">Test Attribute Combinations</a></p>
            <p><a href="/tests/test-unit.html" target="_blank">Unit Tests</a></p>
        </article>
        <article>
            <p>This component serves simply as a convenience to make styling forms and configuring waiting effects and confirmation/error messages less time consuming.</p>
            <h2>Features</h2>
            <ul>
            <li>Set custom &quot;waiting&quot;, &quot;success&quot; and &quot;error&quot; messages.</li>
            <li>Custom messages can be set by either attributes or slots.</li>
            <li>Receive and display messages from the server sent in HTML or JSON format.</li>
            <li>Choose whether the messages appear as a modal.</li>
            <li>Set custom http headers and other fetch options, such as CORS etc.</li>
            <li>Choose whether to reset the form when it is submitted.</li>
            <li>Use the component's default css to style the form, or use your own styles.</li>
            </ul>
            <h2>Usage</h2>
            <p>Add the script to your page:</p>
            <pre><code>&lt;script type=&quot;module&quot; src=&quot;/wijit-form.js&quot;&gt;&lt;/script&gt;
            </code></pre>

            <p>Add the tag around your form:</p>
            <pre><code>&lt;wijit-form&gt;
                &lt;form action=&quot;/some/url/&quot;&gt;...&lt;/form&gt;
            &lt;/wijit-form&gt;
            </code></pre>

            <h2>Description of Features</h2>
            <h3>Custom Messages</h3>
            <p>Instead of displaying the component's default messages, you can display whatever (HTML) message the server sends or you can display your own <strong><em>waiting</em></strong>, <strong><em>success</em></strong> and/or <strong><em>error</em></strong> messages. You may set these messages by either attributes or slots.</p>
            <p>If you don't define a <strong><em>waiting</em></strong> message, the component's default message will display.</p>
            <p>If you don't define a <strong><em>success</em></strong> and/or <strong><em>error</em></strong> message, the displayed message depends on the <strong><em>response</em></strong> attribute:</p>
            <ul>
            <li>If <strong><em>response</em></strong> is set to &quot;json&quot; (default), the component's default message will display.</li>
            <li>If <strong><em>response</em></strong> is set to &quot;html&quot;, the response from the server is displayed.</li>
            </ul>
            <p>If the server typically returns an HTML response and you simply wish to display whatever the server sends, you must set  the <strong><em>response</em></strong> attribute to &quot;html&quot;.</p>
            <pre><code>    &lt;wijit-form response=&quot;html&quot;&gt;...&lt;/wijit-form&gt;
            </code></pre>

            <h4>Custom Message via Attributes</h4>
            <p>To set custom messages with attributes:</p>
            <pre><code>&lt;wijit-form
            waiting=&quot;&lt;h1&gt;Waiting Message&lt;/h1&gt;&quot;
            success=&quot;&lt;h2&gt;Success&lt;/h2&gt;&lt;p&gt;message&lt;/p&gt;&quot;
            error=&quot;error message&quot;&gt;
            ...
            &lt;/wijit-form&gt;
            </code></pre>

            <h4>Custom Message via Slots</h4>
            <p>To set custom messages with slots:</p>
            <pre><code>&lt;wijit-form&gt;
                &lt;form&gt;...&lt;/form&gt;
                &lt;div slot=&quot;waiting&quot; class=&quot;animated-icon&quot;&gt;&lt;/div&gt;
                &lt;div slot=&quot;success&quot;&gt;&lt;h1&gt;Success!&lt;/h1&gt;&lt;p&gt;Thank You&lt;/p&gt;&lt;/div&gt;
                &lt;p slot=&quot;error&quot;&gt;An error occured :(&lt;/p&gt;
            &lt;/wijit-form&gt;
            </code></pre>

            <p>If the server/script to which you submit the form returns responses in JSON format, you have the option to include placeholders in your custom &quot;success&quot; or &quot;error&quot; messages&quot; which map to specific bits of data in the response.</p>
            <p>For example, if the server sends back JSON data in the form of:</p>
            <pre><code>{
                &quot;status&quot;:&quot;success&quot;,
                &quot;message&quot;:&quot;Thank You&quot;,
                &quot;data&quot;: {
                    &quot;name&quot;: &quot;Foo&quot;
                }
            }
            </code></pre>

            <p>You can write your custom success message as:</p>
            <pre><code>&lt;wijit-form success=&quot;{{message}} {{data.name}}&quot;&gt;...&lt;/wijit-form&gt;
            </code></pre>

            <p>Or </p>
            <pre><code>&lt;wijit-form&gt;
                &lt;form&gt;...&lt;/form&gt;
                &lt;div slot=&quot;success&quot;&gt;&lt;h1&gt;{{status}}&lt;/h1&gt;&lt;p&gt;Thanks {{data.name}}&lt;/p&gt;&lt;/div&gt;
            &lt;/wijit-form&gt;
            </code></pre>

            <p>Since &quot;json&quot; is the default value of the &quot;response&quot; property, you don't need to add a &quot;response&quot; attribute manually.</p>
            <h3>Modal vs Non-modal</h3>
            <p>You may also set whether the messages appear as a modal. If you add the &quot;modal&quot; attribute, an overlay will appear over the entire screen and the waiting/success/error message will appear centered in the screen. If the modal attribute is absent, or if it is set to &quot;false&quot;, the waiting/success/error messages will only appear over the form which was submitted.</p>
            <p>To enable a modal dialog:</p>
            <pre><code>&lt;wijit-form modal&gt;...&lt;/wijit-form&gt;
            </code></pre>

            <h3>Custom Fetch Options</h3>
            <p>This web component intercepts the form submission and sends the request to the server via fetch(). You may need to set custom http headers or other fetch options such as CORS directives. These options should be written in valid JSON syntax.</p>
            <p>You do not need to set an &quot;Accept&quot; header. This is done automatically with the &quot;response&quot; attribute. If the value of &quot;response&quot; is &quot;html&quot; the &quot;Accept&quot; header is set to &quot;text/html&quot;. If the value of the &quot;response&quot; attribute is &quot;json&quot; (default), the Accept header is set to &quot;application/json&quot;.</p>
            <p>To set a custom http header:</p>
            <pre><code>&lt;wijit-form
                fetch-options=&quot;{headers:{&quot;X-Requested-With&quot;:&quot;XMLHttpRequest&quot;}}&quot;&gt;
                ...
            &lt;/wijit-form&gt;
            </code></pre>

            <p>If you have many custom fetch options, you may want to add them with javascript.</p>
            <pre><code>&lt;script&gt;
                const component = document.querySelector(&quot;wijit-form&quot;);
                // options should be a String!
                const options = `{
                    headers: {...},
                    mode: &quot;cors&quot;,
                    cache: &quot;default&quot;
                }`;
                component.setAttribute('fetch-options', options);
            &lt;/script&gt;
            </code></pre>

            <h3>Reset Form</h3>
            <p>By default, the form will reset on submission, if you do not want the form to reset, add the &quot;reset-form&quot; attribute with a value of &quot;false&quot;.</p>
            <pre><code>&lt;wijit-form reset-form=&quot;false&quot;&gt;...&lt;/wijit-form&gt;
            </code></pre>

            <h3>Custom CSS</h3>
            <p>By default, the component styles the form and fields with it's own default css styles. If you wish to use your own styles, add this attribute. You may give the attribute a value of &quot;true&quot;, or you may omit the value.</p>
            <pre><code>&lt;wijit-form custom-css&gt;...&lt;/wijit-form&gt;
            </code></pre>

            <h2>Attributes</h2>
            <p>All of these attributes are optional</p>
            <ul>
            <li>
            <p><strong>fetch-options (default: null)</strong> Acceptable values: [Any valid fetch option from: <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API/fetch#options">The MDN Docs</a>]. This should be formatted as a valid JSON string.</p>
            </li>
            <li>
            <p>User Supplied Confirmation Messages. These attributes accept strings. The string may contain HTML.</p>
            <ul>
            <li>
            <p><strong>waiting (default: &quot;<code>&lt;h1&gt;Please Wait...&lt;/h1&gt;</code>&quot;)</strong> Acceptable values: [any string] This is the message displayed after the form is submitted, while the page is waiting for a response from the server.</p>
            </li>
            <li>
            <p><strong>success (default: &quot;<code>&lt;h3&gt;Submission Received&lt;/h3&gt;&lt;p&gt;Thank you!&lt;/p&gt;</code>&quot;)</strong> Acceptable values: [any string] This is the message displayed upon a successful response from the server, meaning the server sent an http status code lower than 400.</p>
            </li>
            <li>
            <p><strong>error (default: &quot;<code>&lt;h3&gt;Oopsie!&lt;/h3&gt;&lt;p&gt;There was an error. Your submission was not received.&lt;/p&gt;</code>&quot;)</strong> Acceptable values: [any string] This is the message displayed when the server reports an error, meaning it sent an http status code greater than 399.</p>
            </li>
            </ul>
            </li>
            <li>
            <p><strong>response (default: &quot;json&quot;)</strong> Acceptable values: [&quot;html&quot;, &quot;json&quot;] The Content Type expected from the server.</p>
            </li>
            <li>
            <p><strong>modal (default: &quot;false&quot;)</strong> Acceptable values: [&quot;true&quot;, &quot;false&quot;] Whether to open the confirmation dialog as a modal. A modal dialog/overlay covers the entire screen. When this value is false, the confirmation dialog/overlay only covers the form which was submitted.</p>
            </li>
            <li>
            <p><strong>reset-form (default: &quot;true&quot;)</strong> Acceptable values: [&quot;true&quot;, &quot;false&quot;] Whether to reset the form after it is submitted.</p>
            </li>
            <li>
            <p><strong>custom-css (default: &quot;false&quot;)</strong> Acceptable values: [&quot;true&quot;, &quot;false&quot;] Whether to use your own custom css styles on the form instead of the default styles.</p>
            </li>
            </ul>
        </article>
    </details>

    <section>
        <header><h2>Demo</h2></header>
        <wijit-form id="demo-form">
            <form action="tests/test-server.php">
                <section class="row">
                    <div>
                        <label for="demo-fetchoptions">fetch-options</label>
                        <textarea
                            id="demo-fetchoptions"
                            oninput="change(event, 'fetch-options')"
                            placeholder="Example: {headers:{Accept:'text/html'}}"></textarea>
                    </div>

                    <fieldset>
                    <legend>Custom Messages</legend>
                        <div>
                            <label for="demo-waiting">waiting</label>
                            <textarea id="demo-waiting" placeholder="Example: <h1>Waiting</h1>" oninput="change(event, 'waiting')"></textarea>
                        </div>
                        <div>
                            <label for="demo-success">success</label>
                            <textarea name="success" id="demo-success" placeholder="Example: <p>Thanks {{data.first}}</p> (Placeholders only work when response is 'json')" oninput="change(event, 'success')"></textarea>
                        </div>
                        <div>
                            <label for="demo-error">error</label>
                            <textarea id="demo-error" placeholder="Example: <h1>Nope!</h1><p>There was an error</p>" oninput="change(event, 'error')"></textarea>
                        </div>
                    </fieldset>

                    <section>
                        <fieldset class="row">
                        <legend>response</legend>
                            <div class="row center">
                                <div>
                                    <label for="demo-response-html">html</label>
                                    <input type="radio" name="response" value="html" id="demo-response-html" onchange="change(event, 'response')">
                                </div>
                                <div>
                                    <label for="demo-response-json">json</label>
                                    <input checked type="radio" name="response" value="json" id="demo-response-json" onchange="change(event, 'response')">
                                </div>
                            </div>
                            <!-- <hr>
                            <div>
                                <label for="demo-force-error">Force Error</label>
                                <input type="checkbox" value="true" id="demo-force-error" onchange="change(event,'force-error')">
                            </div> -->
                        </fieldset>

                        <fieldset class="row">
                        <legend>modal</legend>
                            <select size="2" onchange="change(event, 'modal')">
                                <option>True</option>
                                <option selected>False</option>
                            </select>

                        </fieldset>

                        <fieldset class="row">
                        <legend>reset</legend>
                            <select size="2" onchange="change(event, 'reset-form')">
                                <option>True</option>
                                <option selected>False</option>
                            </select>
                        </fieldset>
                    </section>
                </section>

                <section class="row center">
                    <div class="row">
                        <label for="demo-name1">First</label>
                        <input name="first" id="demo-name1" autocomplete="given-name" value="Foo">
                    </div>
                    <div class="row">
                        <label for="demo-name2">Last</label>
                        <input name="last" id="demo-name2" autocomplete="family-name">
                    </div>

                    <div class="end">
                        <button class="primary">Submit</button>
                    </div>
                </section>

            </form>
        </wijit-form>
    </section>

    <section>
        <header><h2>Examples</h2></header>
        <article>
            <header><h3>Basic Example</h3></header>
            <wijit-form id="ex1">
                <form action="tests/test-server.php">
                    <div>
                        <label for="ex1-name">Name</label>
                        <input name="name" id="ex1-name" autocomplete="name" value="Foo">
                    </div>
                    <div>
                        <label for="ex1-email">Email</label>
                        <input type="email" name="email" id="ex1-email" autocomplete="email">
                    </div>
                    <button>Spam Me!</button>
                </form>
            </wijit-form>
        </article>

        <article>
            <header><h3>HTML Response</h3></header>
            <wijit-form response="html" id="ex2">
                <form action="tests/test-server.php">
                    <div>
                        <label for="ex2-name">Name</label>
                        <input name="name" id="ex2-name" autocomplete="name">
                    </div>
                    <div>
                        <label for="ex2-email">Email</label>
                        <input type="email" name="email" id="ex2-email" autocomplete="email">
                    </div>
                    <button>Spam Me!</button>
                </form>
            </wijit-form>
        </article>

        <article>
            <header><h3>Custom Messages</h3></header>
            <wijit-form id="ex3">
                <form action="tests/test-server.php">
                    <div>
                        <label for="ex3-name" class="required">Name</label>
                        <input required name="name" id="ex3-name" value="Foo" autocomplete="name">
                    </div>
                    <div>
                        <label for="ex3-email">Email</label>
                        <input type="email" name="email" id="ex3-email" autocomplete="email">
                    </div>
                    <button>Spame Me!</button>
                </form>

                <wijit-icon01 slot="waiting" animate color="lime" style="width:85%; margin:auto">Please Wait</wijit-icon01>
                <div slot="success">
                    <h1>Success!</h1>
                    <p>Thank you {{data.name}}</p>
                </div>
                <div slot="error">
                    <h1>{{status}}</h1>
                    <p>Please seek help.</p>
                </div>
            </wijit-form>
        </article>

        <article>
            <header><h3>Modal</h3></header>
            <wijit-form modal id="ex4">
                <form action="tests/test-server.php">
                    <div>
                        <label for="ex4-name">Name</label>
                        <input name="name" id="ex4-name" autocomplete="name">
                    </div>
                    <div>
                        <label for="ex4-email">Email</label>
                        <input type="email" name="email" id="ex4-email" autocomplete="email">
                    </div>
                    <button>Spammie!</button>
                </form>
            </wijit-form>
        </article>
    </section>


    <script>
        function change (event, attr) {
            const elem = document.querySelector('#demo-form');
            const value = (attr === 'force-error') ? event.target.checked : event.target.value;
            elem.setAttribute(attr, value);
        }
    </script>
</body>
</html>
